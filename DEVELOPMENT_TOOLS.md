# Инструменты разработки

## Обзор

Приложение Goal School использует современный набор инструментов для разработки, тестирования и поддержания качества кода.

## Линтинг и форматирование

### ESLint

ESLint используется для статического анализа кода и обеспечения соблюдения стандартов кодирования.

#### Конфигурация

Конфигурация ESLint находится в файле [.eslintrc.js](.eslintrc.js).

#### Основные правила

- Строгая типизация TypeScript
- Правила React Hooks
- Запрет на неиспользуемые переменные
- Обязательное использование const вместо var
- Равенство с помощью === и !==

#### Команды

```bash
# Проверка кода
npm run lint

# Исправление ошибок
npm run lint:fix
```

### Prettier

Prettier используется для автоматического форматирования кода.

#### Конфигурация

Конфигурация Prettier находится в файле [.prettierrc.js](.prettierrc.js).

#### Основные настройки

- Одинарные кавычки
- Точка с запятой в конце строк
- Ширина строки 100 символов
- 2 пробела для отступов

#### Команды

```bash
# Форматирование всего проекта
npm run format

# Проверка форматирования
npm run format:check
```

## Git хуки

### Husky

Husky используется для управления Git хуками.

#### Установка

```bash
npm run prepare
```

#### Pre-commit хук

Перед каждым коммитом автоматически запускаются:

1. Линтинг измененных файлов
2. Форматирование измененных файлов

Конфигурация находится в [.husky/pre-commit](.husky/pre-commit).

### Lint-staged

Lint-staged используется для запуска линтеров и форматтеров только на измененных файлах.

#### Конфигурация

Конфигурация находится в [package.json](package.json) в разделе `lint-staged`.

## Тестирование

### Jest

Jest используется для unit и интеграционного тестирования.

#### Конфигурация

Конфигурация Jest находится в файле [jest.config.js](jest.config.js).

#### Команды

```bash
# Запуск всех тестов
npm test

# Запуск тестов в режиме наблюдения
npm run test:watch

# Запуск тестов с покрытием кода
npm run test:coverage
```

### Testing Library

Testing Library используется для тестирования компонентов React Native.

#### Пример теста

```typescript
import { render, fireEvent } from '@testing-library/react-native';
import { Button } from '../Button';

it('should call onPress when pressed', () => {
  const onPress = jest.fn();
  const { getByText } = render(<Button onPress={onPress}>Click me</Button>);

  fireEvent.press(getByText('Click me'));

  expect(onPress).toHaveBeenCalled();
});
```

## Сборка и развертывание

### Expo

Expo используется для разработки и сборки приложения.

#### Команды

```bash
# Запуск в режиме разработки
npm start

# Запуск на Android
npm run android

# Запуск на iOS
npm run ios

# Запуск в вебе
npm run web

# Сборка веб-версии
npm run build
```

### Docker

Docker используется для контейнеризации приложения.

#### Файлы

- [Dockerfile](Dockerfile) - для продакшн сборки
- [Dockerfile.dev](Dockerfile.dev) - для разработки
- [docker-compose.yml](docker-compose.yml) - для оркестрации сервисов

#### Команды

```bash
# Запуск всех сервисов
docker-compose up

# Сборка образа
docker build -t goalschool .
```

## База данных

### PostgreSQL

PostgreSQL используется как облачная база данных.

#### Скрипты управления

```bash
# Инициализация базы данных
npm run db:init

# Проверка подключения
npm run db:check

# Резервное копирование
npm run db:backup

# Восстановление из резервной копии
npm run db:restore

# Очистка базы данных (только для разработки)
npm run db:clear

# Создание тестовых пользователей
npm run db:create-test-users
```

### Инициализация всего приложения

```bash
# Полная инициализация приложения
npm run app:init
```

## Мониторинг и логирование

### Логирование

Логирование реализовано через console.log и специализированные логгеры.

#### Уровни логирования

1. **Error** - ошибки, требующие немедленного внимания
2. **Warn** - предупреждения
3. **Info** - информационные сообщения
4. **Debug** - отладочная информация

### Мониторинг производительности

Мониторинг производительности осуществляется через:

- Время отклика API
- Использование ресурсов
- Количество ошибок

## Безопасность

### Сканирование уязвимостей

```bash
# Сканирование уязвимостей в зависимостях
npm audit
```

### Обновление зависимостей

Регулярно обновляйте зависимости для устранения уязвимостей:

```bash
# Проверка устаревших зависимостей
npm outdated

# Обновление зависимостей
npm update
```

## CI/CD

### GitHub Actions

CI/CD pipeline реализован через GitHub Actions.

#### Файл конфигурации

[.github/workflows/ci.yml](.github/workflows/ci.yml)

#### Этапы pipeline

1. **Test** - проверка кода и запуск тестов
2. **Build Web** - сборка веб-версии
3. **Build Docker** - сборка Docker образа
4. **Deploy** - деплой на сервер

## Best Practices

### 1. Автоматизация

- Используйте скрипты для повторяющихся задач
- Настройте Git хуки для автоматической проверки кода
- Используйте CI/CD для автоматической сборки и тестирования

### 2. Качество кода

- Следуйте стандартам кодирования
- Пишите тесты для нового функционала
- Проводите code review перед мержем

### 3. Безопасность

- Регулярно обновляйте зависимости
- Используйте переменные окружения для конфиденциальных данных
- Проводите аудит безопасности

### 4. Производительность

- Оптимизируйте код перед коммитом
- Используйте инструменты профилирования
- Мониторьте производительность в production

## Решение常见ых проблем

### Ошибка "husky not found"

Установите husky:

```bash
npm run prepare
```

### Ошибка "lint-staged not found"

Установите зависимости:

```bash
npm install
```

### Ошибка "jest not found"

Установите зависимости для разработки:

```bash
npm install --save-dev jest
```

### Ошибка "eslint not found"

Установите ESLint:

```bash
npm install --save-dev eslint
```

# Развертывание приложения на хостинге Beget

## Описание

Это руководство описывает, как развернуть веб-версию приложения футбольной школы на хостинге Beget с использованием PostgreSQL в качестве базы данных.

## Требования

- Аккаунт на [Beget](https://beget.com)
- Доступ к панели управления Beget
- Установленный Node.js и npm на локальной машине
- Установленный Git

## Подготовка приложения

### 1. Сборка веб-версии приложения

1. Перейдите в директорию проекта:

```bash
cd Goal-School
```

2. Установите зависимости:

```bash
npm install
```

3. Создайте сборку веб-версии:

```bash
npm run build
```

После выполнения этой команды в директории проекта будет создана папка `web-build` с готовой сборкой приложения.

### 2. Настройка переменных окружения

1. Создайте файл `.env` в корне проекта:

```bash
cp .env.example .env
```

2. Заполните параметры подключения к PostgreSQL (будут настроены позже после создания базы данных на Beget).

## Настройка хостинга Beget

### 1. Создание сайта на Beget

1. Войдите в панель управления Beget
2. Перейдите в раздел "Сайты"
3. Нажмите "Добавить сайт"
4. Укажите доменное имя (или используйте временное)
5. Выберите тип сайта "Статический сайт"
6. Нажмите "Создать"

### 2. Создание базы данных PostgreSQL на Beget

1. В панели управления Beget перейдите в раздел "Базы данных"
2. Нажмите "Добавить базу данных"
3. Выберите тип "PostgreSQL"
4. Укажите имя базы данных (например, `goalschool`)
5. Задайте имя пользователя и пароль
6. Нажмите "Создать"

После создания базы данных вы получите параметры подключения:

- Хост
- Порт
- Имя базы данных
- Имя пользователя
- Пароль

### 3. Настройка переменных окружения на Beget

1. В панели управления Beget перейдите в раздел "Сайты"
2. Выберите ваш сайт
3. Перейдите на вкладку "Node.js"
4. В разделе "Переменные окружения" добавьте следующие переменные:

```
POSTGRES_HOST=хост_из_панели_управления
POSTGRES_PORT=порт_из_панели_управления
POSTGRES_DATABASE=имя_базы_данных
POSTGRES_USER=имя_пользователя
POSTGRES_PASSWORD=пароль
```

## Загрузка файлов на сервер

### Вариант 1: Через FTP/SFTP

1. Получите данные для подключения в панели управления Beget
2. Используйте FTP-клиент (например, FileZilla) для загрузки файлов
3. Загрузите содержимое папки `web-build` в корневую директорию сайта

### Вариант 2: Через Git

1. В панели управления Beget перейдите в раздел "Сайты"
2. Выберите ваш сайт
3. Перейдите на вкладку "Git"
4. Укажите URL вашего репозитория
5. Настройте ветку (обычно `main` или `master`)
6. Укажите путь к директории сборки (`web-build`)
7. Нажмите "Подключить"

## Инициализация базы данных

### 1. Подключение к базе данных через SSH

1. В панели управления Beget перейдите в раздел "SSH"
2. Включите SSH-доступ
3. Подключитесь по SSH:

```bash
ssh имя_пользователя@хост_ssh
```

### 2. Загрузка и выполнение скрипта инициализации

1. Скопируйте файлы инициализации на сервер:

```bash
scp -r src/config/db.ts имя_пользователя@хост_ssh:~
scp -r src/services/DatabaseInitService.ts имя_пользователя@хост_ssh:~
scp -r scripts/init-database.js имя_пользователя@хост_ssh:~
```

2. На сервере выполните инициализацию:

```bash
node init-database.js
```

## Настройка Node.js приложения на Beget

### 1. В панели управления Beget

1. Перейдите в раздел "Сайты"
2. Выберите ваш сайт
3. Перейдите на вкладку "Node.js"
4. Укажите точку входа (например, `server.js`)
5. Установите необходимые зависимости:

```bash
npm install express pg dotenv
```

### 2. Создание серверного файла

Создайте файл `server.js` в корне проекта:

```javascript
const express = require('express');
const path = require('path');
const { initializeDatabase } = require('./src/config/db');

// Инициализация базы данных
initializeDatabase().catch(error => {
  console.error('Ошибка инициализации базы данных:', error);
});

const app = express();
const PORT = process.env.PORT || 3000;

// Обслуживание статических файлов
app.use(express.static(path.join(__dirname, 'web-build')));

// Обработка всех маршрутов
app.get('*', (req, res) => {
  res.sendFile(path.join(__dirname, 'web-build', 'index.html'));
});

app.listen(PORT, () => {
  console.log(`Сервер запущен на порту ${PORT}`);
});
```

## Настройка домена

1. В панели управления Beget перейдите в раздел "Домены"
2. Добавьте ваш домен
3. Настройте DNS-записи согласно инструкции Beget
4. В разделе "Сайты" привяжите домен к вашему сайту

## Тестирование

1. Откройте ваш сайт в браузере
2. Проверьте, что приложение загружается корректно
3. Проверьте работу всех функций (регистрация, вход, навигация)
4. Убедитесь, что данные сохраняются в базе данных

## Обслуживание и мониторинг

### Логи приложения

1. В панели управления Beget перейдите в раздел "Сайты"
2. Выберите ваш сайт
3. Перейдите на вкладку "Node.js"
4. Просматривайте логи в разделе "Логи"

### Резервное копирование

1. Регулярно создавайте резервные копии базы данных через панель управления Beget
2. Храните резервные копии в безопасном месте

### Обновление приложения

1. При использовании Git: сделайте push в репозиторий, и Beget автоматически обновит приложение
2. При использовании FTP: загрузите новые файлы вручную

## Устранение неполадок

### Приложение не загружается

1. Проверьте логи Node.js приложения
2. Убедитесь, что все зависимости установлены
3. Проверьте правильность переменных окружения

### Ошибка подключения к базе данных

1. Проверьте параметры подключения в переменных окружения
2. Убедитесь, что база данных доступна
3. Проверьте логи базы данных

### Ошибка инициализации базы данных

1. Проверьте, что таблицы созданы корректно
2. Убедитесь, что у пользователя есть необходимые права
3. Проверьте логи инициализации

## Безопасность

1. Используйте HTTPS для вашего сайта
2. Регулярно обновляйте зависимости
3. Не храните чувствительные данные в открытом виде
4. Ограничьте доступ к панели управления

## Поддержка

Если у вас возникли проблемы с развертыванием приложения на Beget, обратитесь в службу поддержки Beget или создайте issue в репозитории проекта.

# Руководство по развертыванию приложения на Beget

## Подготовка к развертыванию

1. Убедитесь, что у вас есть аккаунт на [beget.com](https://beget.com)
2. Подготовьте файлы приложения для загрузки
3. Настройте домен (опционально)

## Подготовка файлов приложения

1. Соберите веб-версию приложения:

   ```bash
   npm run build
   # или
   expo export:web
   ```

2. Архивируйте содержимое папки `web-build` в ZIP-архив

## Загрузка файлов на Beget

1. Войдите в панель управления Beget
2. Перейдите в раздел "Сайты"
3. Выберите нужный сайт или создайте новый
4. Перейдите в файловый менеджер сайта
5. Загрузите подготовленный ZIP-архив
6. Распакуйте архив в корневую директорию сайта

## Настройка Node.js приложения (если используется сервер)

1. В панели управления Beget перейдите в раздел "Node.js"
2. Создайте новое Node.js приложение
3. Укажите путь к главному файлу сервера (например, `server.js`)
4. Установите необходимые зависимости:
   ```bash
   npm install
   ```

## Настройка переменных окружения

1. В панели управления Beget перейдите в раздел "Node.js"
2. В настройках приложения найдите раздел "Переменные окружения"
3. Добавьте необходимые переменные:
   - `DATABASE_URL` - URL подключения к PostgreSQL
   - `NODE_ENV` - режим работы (production/development)

## Настройка базы данных PostgreSQL

1. В панели управления Beget перейдите в раздел "Базы данных"
2. Создайте новую базу данных PostgreSQL 16.4
3. Запишите параметры подключения:
   - Хост
   - Порт
   - Имя базы данных
   - Имя пользователя
   - Пароль

## Настройка домена (опционально)

1. В панели управления Beget перейдите в раздел "Домены"
2. Добавьте новый домен или поддомен
3. Настройте DNS-записи согласно инструкции Beget

## Запуск приложения

1. После загрузки файлов и настройки базы данных перезапустите Node.js приложение в панели Beget
2. Проверьте логи приложения на наличие ошибок
3. Откройте сайт в браузере для проверки работоспособности

## Решение常见ых проблем

### Ошибка "Module not found"

Убедитесь, что все зависимости установлены:

```bash
npm install
```

### Ошибка подключения к базе данных

Проверьте правильность переменных окружения и доступность базы данных.

### Ошибка 502 Bad Gateway

Проверьте логи Node.js приложения и убедитесь, что сервер запущен и слушает правильный порт.

## Дополнительные рекомендации

1. Используйте систему контроля версий (Git) для управления кодом
2. Регулярно создавайте резервные копии базы данных
3. Мониторьте логи приложения на наличие ошибок
4. Используйте HTTPS для безопасности

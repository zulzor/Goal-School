# Конфигурация приложения для Beget

## Переменные окружения

При развертывании на Beget необходимо настроить следующие переменные окружения:

### Обязательные переменные

```env
# PostgreSQL Database Configuration
DATABASE_URL=postgresql://username:password@host:port/database_name
DB_HOST=your_database_host
DB_PORT=5432
DB_NAME=your_database_name
DB_USER=your_database_user
DB_PASSWORD=your_database_password
DB_SSL=true

# Application Configuration
NODE_ENV=production
PORT=3000

# Security
JWT_SECRET=your_jwt_secret_key
BCRYPT_SALT_ROUNDS=10
```

## Настройка Node.js приложения в панели Beget

1. Войдите в панель управления Beget
2. Перейдите в раздел "Node.js"
3. Создайте новое приложение со следующими параметрами:
   - Путь к файлу: `server.js`
   - Версия Node.js: 16 или выше
   - Домен: ваш домен или поддомен

## Настройка базы данных PostgreSQL в Beget

1. В панели управления Beget перейдите в раздел "Базы данных"
2. Создайте новую базу данных PostgreSQL 16.4
3. Запишите параметры подключения:
   - Хост
   - Порт
   - Имя базы данных
   - Имя пользователя
   - Пароль

## Инициализация базы данных

После настройки переменных окружения выполните инициализацию базы данных:

```bash
npm run db:init
```

## Настройка HTTPS

Beget автоматически предоставляет SSL-сертификаты для доменов. Убедитесь, что ваше приложение корректно работает с HTTPS.

## Настройка кастомного домена

1. В панели управления Beget перейдите в раздел "Домены"
2. Добавьте ваш домен
3. Настройте DNS-записи согласно инструкции Beget:
   - A-запись, указывающая на IP-адрес сервера Beget
   - CNAME-запись для поддоменов (если необходимо)

## Мониторинг и логи

1. В панели Beget перейдите в раздел "Node.js"
2. Выберите ваше приложение
3. Просматривайте логи в реальном времени
4. Настраивайте уведомления об ошибках

## Резервное копирование

1. Регулярно создавайте резервные копии базы данных:
   ```bash
   npm run db:backup
   ```
2. Скачивайте резервные копии с сервера Beget для хранения в безопасном месте

## Обновление приложения

1. Загрузите новые файлы через файловый менеджер Beget
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Перезапустите Node.js приложение в панели Beget

## Решение常见ых проблем

### Ошибка "Application failed to start"

1. Проверьте логи приложения в панели Beget
2. Убедитесь, что все переменные окружения настроены правильно
3. Проверьте подключение к базе данных

### Ошибка подключения к базе данных

1. Проверьте параметры подключения в переменных окружения
2. Убедитесь, что база данных доступна и запущена
3. Проверьте, что IP-адрес сервера приложения добавлен в список разрешенных для подключения к базе данных

### Ошибка "Module not found"

1. Убедитесь, что все зависимости установлены:
   ```bash
   npm install
   ```
2. Проверьте, что файл package.json содержит все необходимые зависимости

### Проблемы с производительностью

1. Проверьте использование ресурсов в панели Beget
2. Оптимизируйте запросы к базе данных
3. Используйте кэширование где это возможно
4. Рассмотрите возможность перехода на более мощный тарифный план

# Функциональность филиалов в приложении футбольной школы Arsenal

## Введение

Этот документ описывает реализацию функциональности филиалов в приложении футбольной школы "Арсенал". Система филиалов позволяет разделить пользователей и данные по географическим подразделениям школы, обеспечивая правильную организацию и доступ к информации.

## Архитектура системы филиалов

### Компоненты системы

```
Branch Management System
├── Branch Service
├── Branch Context
├── Branch Repository (AsyncStorage)
└── Branch UI Components
```

### Основные сущности

1. **Branch (Филиал)** - географическое подразделение школы
2. **User (Пользователь)** - пользователь системы с привязкой к филиалу

## Реализация функциональности

### 1. Типы данных

В системе определены следующие типы для работы с филиалами:

```typescript
interface Branch {
  id: string;
  name: string;
  address?: string;
  phone?: string;
  email?: string;
  createdAt?: string;
  updatedAt?: string;
}

interface User {
  // ... существующие поля ...
  branchId?: string; // Привязка к филиалу
}
```

### 2. Сервис филиалов

Сервис [BranchService](file:///c%3A/Users/jolab/Desktop/Goal-School/src/services/BranchService.ts) предоставляет следующие функции:

- `getBranches()` - получение списка всех филиалов
- `createBranch()` - создание нового филиала
- `updateBranch()` - обновление информации о филиале
- `deleteBranch()` - удаление филиала
- `getBranchById()` - получение филиала по ID

### 3. Контекст филиалов

Контекст [BranchContext](file:///c%3A/Users/jolab/Desktop/Goal-School/src/context/BranchContext.tsx) предоставляет React-хуки для работы с филиалами в компонентах:

- `useBranch()` - хук для доступа к функциям управления филиалами

### 4. Интеграция с аутентификацией

Контекст аутентификации был обновлен для поддержки привязки пользователей к филиалам:

- При регистрации пользователь должен выбрать филиал
- В профиле отображается информация о филиале пользователя

## Пользовательский интерфейс

### 1. Экран регистрации

На экране регистрации добавлен выбор филиала из списка существующих филиалов. Пользователь должен выбрать филиал перед регистрацией.

### 2. Профиль пользователя

В профиле пользователя отображается информация о филиале, к которому привязан пользователь.

### 3. Управление филиалами

Для пользователей с ролями "manager" и "admin" добавлен экран управления филиалами, который позволяет:

- Просматривать список всех филиалов
- Создавать новые филиалы
- Редактировать информацию о филиалах
- Удалять филиалы

## Технические детали

### Хранение данных

Филиалы хранятся в локальном хранилище AsyncStorage с ключом `app_branches`. При первом запуске создаются два стандартных филиала:

1. Футбольная школа "Арсенал" Жулебино
2. Футбольная школа "Арсенал" Дмитриевское

### Навигация

В навигационное меню для ролей "manager" и "admin" добавлен пункт "Филиалы", ведущий на экран управления филиалами.

## Тестирование

Для сервиса филиалов созданы unit-тесты, покрывающие все основные функции:

- Получение филиалов
- Создание филиалов
- Обновление филиалов
- Удаление филиалов
- Обработка ошибок

## Безопасность

Система филиалов реализует следующие меры безопасности:

- Проверка прав доступа к управлению филиалами (только для manager и admin)
- Валидация данных при создании и обновлении филиалов
- Обработка ошибок и исключительных ситуаций

## Расширяемость

Архитектура системы филиалов позволяет легко расширять функциональность:

- Добавление новых полей к филиалам
- Реализация фильтрации данных по филиалам в других сервисах
- Интеграция с внешними системами управления филиалами

## Заключение

Система филиалов успешно реализована и интегрирована в приложение. Она обеспечивает правильную организацию пользователей и данных по географическим подразделениям школы, что упрощает управление и повышает удобство использования приложения.
